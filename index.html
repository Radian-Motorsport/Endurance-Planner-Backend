<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sim Racing Strategy Planner</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.1/css/all.min.css">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f3f4f6;
        }
        input[type="number"]::-webkit-inner-spin-button,
        input[type="number"]::-webkit-outer-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="number"] {
            -moz-appearance: textfield;
        }
    </style>
</head>
<body class="p-4 md:p-8">

    <div class="max-w-4xl mx-auto bg-white p-6 md:p-10 rounded-xl shadow-lg">
        <h1 class="text-3xl md:text-4xl font-extrabold text-center text-gray-800 mb-6">Sim Racing Strategy Planner</h1>
        <p class="text-center text-gray-600 mb-8">Plan your race strategy, pit stops, and driver stints with ease.</p>

        <div id="app-container">

            <div id="page-1" class="space-y-6">
                <h2 class="text-2xl font-bold mb-4 text-gray-700">1. Setup</h2>
                
                <div class="p-6 bg-gray-50 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Drivers <span class="text-sm text-gray-500">(Max 6)</span></h3>
                    <div class="flex items-center space-x-2 mb-4">
                        <select id="driver-select" class="p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200 w-full">
                            <option value="">Select a Driver...</option>
                        </select>
                        <button onclick="addDriver()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                            <i class="fas fa-plus"></i> Add
                        </button>
                    </div>
                    <ul id="driver-list" class="space-y-2"></ul>
                </div>

                <div class="p-6 bg-gray-50 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Car & Track</h3>
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="flex flex-col">
                            <label for="car-select" class="text-sm font-medium text-gray-700">Car</label>
                            <select id="car-select" class="mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                                <option value="">Select a Car...</option>
                            </select>
                        </div>
                        <div class="flex flex-col">
                            <label for="track-select" class="text-sm font-medium text-gray-700">Track</label>
                            <select id="track-select" class="mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                                <option value="">Select a Track...</option>
                            </select>
                        </div>
                    </div>
                </div>

                <div class="mt-8">
                    <button onclick="showPage2()" class="w-full bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                        Continue <i class="fas fa-arrow-right ml-2"></i>
                    </button>
                    <button onclick="showAdminPage()" class="w-full mt-4 bg-gray-600 hover:bg-gray-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                        <i class="fas fa-user-shield mr-2"></i> Admin Page
                    </button>
                </div>
            </div>

            <div id="page-2" class="space-y-6 hidden">

                <button onclick="showPage1()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105 mb-6">
                    <i class="fas fa-arrow-left mr-2"></i> Back
                </button>
                
                <h2 class="text-2xl font-bold mb-4 text-gray-700">2. Race Details</h2>

                <div class="p-6 bg-gray-50 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Race Inputs</h3>
                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
                        <div class="flex flex-col">
                            <label class="text-sm font-medium text-gray-700">Car</label>
                            <span id="car-display" class="mt-1 p-3 bg-white border border-gray-300 rounded-lg text-gray-900">N/A</span>
                        </div>
                        <div class="flex flex-col">
                            <label class="text-sm font-medium text-gray-700">Track</label>
                            <span id="track-display" class="mt-1 p-3 bg-white border border-gray-300 rounded-lg text-gray-900">N/A</span>
                        </div>
                        <div class="flex flex-col">
                            <label class="text-sm font-medium text-gray-700">Potential SOF</label>
                            <span id="sof-display" class="mt-1 p-3 bg-white border border-gray-300 rounded-lg text-gray-900">N/A</span>
                        </div>
                        
                        <div class="flex flex-col">
                            <label class="text-sm font-medium text-gray-700">Avg. Lap Time</label>
                            <div class="flex items-center mt-1 space-x-2">
                                <input type="number" id="avg-lap-time-minutes" min="0" value="1" class="p-3 border border-gray-300 rounded-lg w-20 text-center focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                                <span class="text-gray-600">min</span>
                                <input type="number" id="avg-lap-time-seconds" min="0" max="59" value="45" class="p-3 border border-gray-300 rounded-lg w-20 text-center focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                                <span class="text-gray-600">sec</span>
                            </div>
                        </div>

                        <div class="flex flex-col">
                            <label for="fuel-per-lap" class="text-sm font-medium text-gray-700">Fuel Per Lap (L)</label>
                            <input type="number" id="fuel-per-lap" value="3.5" step="0.1" class="mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                        </div>
                        
                        <div class="flex flex-col">
                            <label class="text-sm font-medium text-gray-700">Race Duration</label>
                            <div class="flex items-center mt-1 space-x-2">
                                <input type="number" id="race-duration-hours" min="0" value="1" class="p-3 border border-gray-300 rounded-lg w-20 text-center focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                                <span class="text-gray-600">hr</span>
                                <input type="number" id="race-duration-minutes" min="0" max="59" value="0" class="p-3 border border-gray-300 rounded-lg w-20 text-center focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                                <span class="text-gray-600">min</span>
                            </div>
                        </div>
                        
                        <div class="flex flex-col">
                            <label for="tank-capacity" class="text-sm font-medium text-gray-700">Tank Capacity (L)</label>
                            <input type="number" id="tank-capacity" value="95" class="mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                        </div>
                        
                        <div class="flex flex-col">
                            <label for="pit-stop-time" class="text-sm font-medium text-gray-700">Avg. Pit Stop Time (sec)</label>
                            <input type="number" id="pit-stop-time" value="30" class="mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                        </div>
                    </div>
                </div>

                <div class="mt-8 text-center">
                    <button id="calculate-button" onclick="calculateAndShowPage2()" class="w-full sm:w-auto bg-green-600 hover:bg-green-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                        Calculate Strategy <i class="fas fa-calculator ml-2"></i>
                    </button>
                </div>

                <div id="overall-summary" class="p-6 bg-blue-100 border border-blue-200 rounded-lg hidden">
                    <h3 class="text-xl font-bold mb-4 text-blue-800">Overall Strategy Summary</h3>
                    <div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4 text-blue-800">
                        <div><span class="font-semibold">Est. Laps:</span> <span id="est-laps-display"></span></div>
                        <div><span class="font-semibold">Stint Duration:</span> <span id="stint-duration-display"></span></div>
                        <div><span class="font-semibold">Laps per Stint:</span> <span id="laps-per-stint-display"></span></div>
                        <div><span class="font-semibold">Pit Stops:</span> <span id="pit-stops-display"></span></div>
                        <div><span class="font-semibold">Total Fuel:</span> <span id="total-fuel-display"></span></div>
                        <div><span class="font-semibold">Fuel per Lap:</span> <span id="fuel-per-lap-display"></span></div>
                        <div><span class="font-semibold">Lap Time:</span> <span id="lap-time-display"></span></div>
                        <div><span class="font-semibold">Pit Stop Duration:</span> <span id="pit-stop-duration-display"></span></div>
                    </div>
                </div>

                <div class="p-6 bg-gray-50 border border-gray-200 rounded-lg hidden" id="sliders-container">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Dynamic Adjustments</h3>
                    <div class="flex flex-col sm:flex-row justify-between items-start sm:items-center space-y-4 sm:space-y-0 sm:space-x-4">
                        <div class="flex-grow w-full">
                            <label for="fuel-slider" class="text-sm font-medium text-gray-700">Adjust Fuel per Lap</label>
                            <div class="flex items-center mt-1 space-x-2">
                                <input type="range" id="fuel-slider" min="-1.0" max="1.0" value="0" step="0.1" class="w-full">
                                <span id="fuel-slider-value" class="text-gray-900 font-mono text-sm w-12 text-right">0.0</span> L
                            </div>
                        </div>
                        <div class="flex-grow w-full">
                            <label for="lap-time-slider" class="text-sm font-medium text-gray-700">Adjust Lap Time</label>
                            <div class="flex items-center mt-1 space-x-2">
                                <input type="range" id="lap-time-slider" min="-3" max="3" value="0" step="1" class="w-full">
                                <span id="lap-time-slider-value" class="text-gray-900 font-mono text-sm w-12 text-right">0</span> sec
                            </div>
                        </div>
                    </div>
                </div>
                
                <h2 class="text-2xl font-bold mb-4 mt-8 text-gray-700">Stint Breakdown</h2>
                <div id="stint-breakdown-display" class="p-6 bg-gray-50 border border-gray-200 rounded-lg overflow-x-auto hidden">
                    
                    <div class="flex flex-col mb-4">
                        <label class="text-sm font-medium text-gray-700">Race Start & Qualifying</label>
                        <div class="flex items-center space-x-2">
                            <input type="time" id="race-start-time-page2" value="13:00" class="mt-1 p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                            <span class="text-gray-700 font-bold">+</span>
                            <input type="number" id="qualifying-minutes-page2" min="0" max="59" value="0" class="mt-1 p-3 border border-gray-300 rounded-lg w-20 text-center focus:outline-none focus:ring-2 focus:ring-blue-500 transition duration-200">
                            <span class="text-sm font-medium text-gray-700">min (Qualifying)</span>
                            <button id="recalculate-button" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-lg transition-all duration-200 transform hover:scale-105" onclick="calculateAndShowPage2()">Update</button>
                        </div>
                    </div>
                    
                    <table class="min-w-full divide-y divide-gray-200 border border-gray-300 rounded-lg">
                        <thead class="bg-gray-200">
                            <tr>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider border-r border-gray-300">Start Time</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider border-r border-gray-300">End Time</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider border-r border-gray-300">Start Lap</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider border-r border-gray-300">End Lap</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider border-r border-gray-300">Driver</th>
                                <th class="px-6 py-3 text-left text-xs font-medium text-gray-700 uppercase tracking-wider">Backup</th>
                            </tr>
                        </thead>
                        <tbody id="stint-table-body" class="bg-white divide-y divide-gray-200">
                        </tbody>
                    </table>
                </div>

                <div id="share-link-container" class="p-6 bg-purple-100 border border-purple-200 rounded-lg hidden">
                    <h3 class="text-xl font-semibold mb-4 text-purple-800">Share/Save This Strategy</h3>
                    <div class="flex items-center space-x-2">
                        <button onclick="generateShareLink()" class="bg-purple-600 hover:bg-purple-700 text-white font-bold py-2 px-4 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                            <i class="fas fa-share-alt mr-2"></i> Generate Link
                        </button>
                        <input type="text" id="share-link-output" readonly class="flex-grow p-2 border border-gray-300 rounded-lg bg-gray-50 text-gray-700 cursor-copy" placeholder="Click 'Generate Link' to create a shareable URL">
                        <button onclick="copyShareLink()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                            <i class="fas fa-copy"></i>
                        </button>
                    </div>
                </div>
            </div>

            <div id="admin-page" class="space-y-6 hidden">
                <button onclick="showPage1()" class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-2 px-4 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105 mb-6">
                    <i class="fas fa-arrow-left mr-2"></i> Back
                </button>
                <h2 class="text-2xl font-bold mb-4 text-gray-700">Admin Panel</h2>
                <p class="text-gray-600 mb-8">Manage the data for drivers, cars, and tracks.</p>

                <div class="p-6 bg-gray-50 border border-gray-200 rounded-lg">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Manage Drivers</h3>
                    <div class="space-y-4">
                        <div class="flex flex-col md:flex-row md:items-end md:space-x-4 space-y-4 md:space-y-0">
                            <div class="flex-grow">
                                <label for="new-driver-name" class="text-sm font-medium text-gray-700">Driver Name</label>
                                <input type="text" id="new-driver-name" class="mt-1 p-3 border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="new-driver-irating" class="text-sm font-medium text-gray-700">iRating</label>
                                <input type="number" id="new-driver-irating" class="mt-1 p-3 border border-gray-300 rounded-lg w-28 text-center focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="new-driver-license" class="text-sm font-medium text-gray-700">License</label>
                                <input type="text" id="new-driver-license" class="mt-1 p-3 border border-gray-300 rounded-lg w-28 text-center focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <button id="add-driver-btn" onclick="addDriverAdmin()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                                Add Driver
                            </button>
                        </div>
                        <ul id="admin-driver-list" class="space-y-2 mt-4"></ul>
                    </div>
                </div>

                <div class="p-6 bg-gray-50 border border-gray-200 rounded-lg mt-6">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Manage Cars</h3>
                    <div class="space-y-4">
                        <div class="flex flex-col md:flex-row md:items-end md:space-x-4 space-y-4 md:space-y-0">
                            <div class="flex-grow">
                                <label for="new-car-name" class="text-sm font-medium text-gray-700">Car Name</label>
                                <input type="text" id="new-car-name" class="mt-1 p-3 border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="new-car-fuel" class="text-sm font-medium text-gray-700">Fuel Per Lap (L)</label>
                                <input type="number" id="new-car-fuel" step="0.1" class="mt-1 p-3 border border-gray-300 rounded-lg w-32 text-center focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <div>
                                <label for="new-car-tank" class="text-sm font-medium text-gray-700">Tank Capacity (L)</label>
                                <input type="number" id="new-car-tank" class="mt-1 p-3 border border-gray-300 rounded-lg w-32 text-center focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <button id="add-car-btn" onclick="addCarAdmin()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                                Add Car
                            </button>
                        </div>
                        <ul id="admin-car-list" class="space-y-2 mt-4"></ul>
                    </div>
                </div>
                
                <div class="p-6 bg-gray-50 border border-gray-200 rounded-lg mt-6">
                    <h3 class="text-xl font-semibold mb-4 text-gray-800">Manage Tracks</h3>
                    <div class="space-y-4">
                        <div class="flex flex-col md:flex-row md:items-end md:space-x-4 space-y-4 md:space-y-0">
                            <div class="flex-grow">
                                <label for="new-track-name" class="text-sm font-medium text-gray-700">Track Name</label>
                                <input type="text" id="new-track-name" class="mt-1 p-3 border border-gray-300 rounded-lg w-full focus:outline-none focus:ring-2 focus:ring-blue-500">
                            </div>
                            <button id="add-track-btn" onclick="addTrackAdmin()" class="bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg shadow-md transition-all duration-200 transform hover:scale-105">
                                Add Track
                            </button>
                        </div>
                        <ul id="admin-track-list" class="space-y-2 mt-4"></ul>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global state
        let drivers = [];
        let cars = [];
        let tracks = [];
        let selectedDrivers = [];
        let totalStints = 0;
        let raceDurationSeconds = 0;
        let lapsPerStint = 0;
        let lapsInLastStint = 0;

        // On initial page load
        window.onload = function() {
            fetchDataAndPopulate();
            // Event listeners for dynamic sliders
            const fuelSlider = document.getElementById('fuel-slider');
            const fuelSliderValue = document.getElementById('fuel-slider-value');
            const lapTimeSlider = document.getElementById('lap-time-slider');
            const lapTimeSliderValue = document.getElementById('lap-time-slider-value');
            
            if (fuelSlider) {
                fuelSlider.addEventListener('input', () => {
                    fuelSliderValue.textContent = parseFloat(fuelSlider.value).toFixed(1);
                    calculateAndShowPage2();
                });
            }
            if (lapTimeSlider) {
                lapTimeSlider.addEventListener('input', () => {
                    lapTimeSliderValue.textContent = lapTimeSlider.value;
                    calculateAndShowPage2();
                });
            }
        };

        // Function to fetch data from the server
        async function fetchDataAndPopulate() {
            try {
                const response = await fetch('/api/data');
                const data = await response.json();
                drivers = data.drivers;
                cars = data.cars;
                tracks = data.tracks;
                
                populateDrivers();
                populateCars();
                populateTracks();

                const urlParams = new URLSearchParams(window.location.search);
                if (urlParams.get('state')) {
                    const decodedState = JSON.parse(atob(urlParams.get('state')));
                    loadState(decodedState);
                }
            } catch (error) {
                console.error('Failed to fetch data:', error);
                alert('Could not load data from the server. Please check the server status.');
            }
        }

        // Helper function to show pages
        function showPage1() {
            document.getElementById('page-1').classList.remove('hidden');
            document.getElementById('page-2').classList.add('hidden');
            document.getElementById('admin-page').classList.add('hidden');
        }
        function showPage2() {
            const carSelect = document.getElementById('car-select');
            const trackSelect = document.getElementById('track-select');
            if (selectedDrivers.length === 0 || !carSelect.value || !trackSelect.value) {
                alert("Please select at least one driver, a car, and a track before continuing.");
                return;
            }
            document.getElementById('page-1').classList.add('hidden');
            document.getElementById('page-2').classList.remove('hidden');
            document.getElementById('admin-page').classList.add('hidden');

            // Update Page 2 displays
            const selectedCar = cars.find(c => c.name === carSelect.value);
            document.getElementById('car-display').textContent = selectedCar.name;
            document.getElementById('track-display').textContent = trackSelect.value;
            document.getElementById('fuel-per-lap').value = selectedCar.fuelPerLap;
            document.getElementById('tank-capacity').value = selectedCar.tankCapacity;

            const totalIRating = selectedDrivers.reduce((sum, driver) => sum + driver.iRating, 0);
            const sof = Math.round(totalIRating / selectedDrivers.length);
            document.getElementById('sof-display').textContent = sof;
            
            // Show sections and perform initial calculation
            document.getElementById('overall-summary').classList.remove('hidden');
            document.getElementById('stint-breakdown-display').classList.remove('hidden');
            document.getElementById('sliders-container').classList.remove('hidden');
            document.getElementById('share-link-container').classList.remove('hidden');
            
            calculateAndShowPage2();
        }
        function showAdminPage() {
            document.getElementById('page-1').classList.add('hidden');
            document.getElementById('page-2').classList.add('hidden');
            document.getElementById('admin-page').classList.remove('hidden');
            renderAdminLists();
            resetDriverAdminForm();
            resetCarAdminForm();
            resetTrackAdminForm();
        }

        // --- Core Logic ---

        function calculateAndShowPage2() {
            // Your existing calculation logic here
        }
        function formatDuration(totalSeconds) {
            // Your existing formatDuration logic here
        }
        function secondsToTimeString(totalSeconds) {
            // Your existing secondsToTimeString logic here
        }
        
        // --- Populating Dropdowns and Lists ---

        function populateDrivers() {
            // Your existing populateDrivers logic here
        }
        function populateCars() {
            // Your existing populateCars logic here
        }
        function populateTracks() {
            // Your existing populateTracks logic here
        }
        function addDriver() {
            // Your existing addDriver logic here
        }
        function removeDriver(name) {
            // Your existing removeDriver logic here
        }
        function renderDriverList() {
            // Your existing renderDriverList logic here
        }
        function populateStintTable(avgLapTimeInSeconds) {
            // Your existing populateStintTable logic here
        }

        // --- Share Link Logic ---

        function saveState() {
            // Your existing saveState logic here
        }
        function generateShareLink() {
            // Your existing generateShareLink logic here
        }
        function copyShareLink() {
            // Your existing copyShareLink logic here
        }
        function loadState(state) {
            // Your existing loadState logic here
        }
        
        // --- Admin Functions ---

        async function saveDataToServer() {
            try {
                await fetch('/api/data', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ drivers, cars, tracks })
                });
            } catch (error) {
                console.error('Failed to save data:', error);
                alert('Could not save data to the server.');
            }
        }
        
        function renderAdminLists() {
            // Your existing renderAdminLists logic here
        }
        function resetDriverAdminForm() {
            // Your existing resetDriverAdminForm logic here
        }
        async function addDriverAdmin() {
            // Your existing addDriverAdmin logic here, now with a call to saveDataToServer()
        }
        function editDriverAdmin(name) {
            // Your existing editDriverAdmin logic here
        }
        async function updateDriverAdmin(originalName) {
            // Your existing updateDriverAdmin logic here, now with a call to saveDataToServer()
        }
        async function removeDriverAdmin(name) {
            // Your existing removeDriverAdmin logic here, now with a call to saveDataToServer()
        }
        function resetCarAdminForm() {
            // Your existing resetCarAdminForm logic here
        }
        async function addCarAdmin() {
            // Your existing addCarAdmin logic here, now with a call to saveDataToServer()
        }
        function editCarAdmin(name) {
            // Your existing editCarAdmin logic here
        }
        async function updateCarAdmin(originalName) {
            // Your existing updateCarAdmin logic here, now with a call to saveDataToServer()
        }
        async function removeCarAdmin(name) {
            // Your existing removeCarAdmin logic here, now with a call to saveDataToServer()
        }
        function resetTrackAdminForm() {
            // Your existing resetTrackAdminForm logic here
        }
        async function addTrackAdmin() {
            // Your existing addTrackAdmin logic here, now with a call to saveDataToServer()
        }
        function editTrackAdmin(name) {
            // Your existing editTrackAdmin logic here
        }
        async function updateTrackAdmin(originalName) {
            // Your existing updateTrackAdmin logic here, now with a call to saveDataToServer()
        }
        async function removeTrackAdmin(name) {
            // Your existing removeTrackAdmin logic here, now with a call to saveDataToServer()
        }
    </script>
</body>
</html>
